# ğŸ¯ Routing Agent åŠŸèƒ½å®Œæˆï¼

åŸºäº Agentic Design Patterns çš„ **Routingï¼ˆè·¯ç”±ï¼‰** è®¾è®¡æ¨¡å¼ï¼Œä¸ºä½ åˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´çš„ã€å¯ç”¨çš„ Routing Agent ç³»ç»Ÿï¼

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. æ ¸å¿ƒå®ç° ğŸ”§

**æ–‡ä»¶**: `src/shuyixiao_agent/agents/routing_agent.py`

åˆ›å»ºäº†å®Œæ•´çš„ Routing Agent å®ç°ï¼š
- âœ… `RoutingAgent` æ ¸å¿ƒç±»
- âœ… `RouteConfig` è·¯ç”±é…ç½®ç±»
- âœ… `RoutingResult` ç»“æœç±»
- âœ… `RoutingStrategy` è·¯ç”±ç­–ç•¥æšä¸¾
- âœ… æ”¯æŒå¤šç§è·¯ç”±ç­–ç•¥ï¼ˆè§„åˆ™ã€å…³é”®è¯ã€LLMã€æ··åˆï¼‰
- âœ… è¯¦ç»†çš„è·¯ç”±è¿½è¸ªå’Œæ—¥å¿—
- âœ… é”™è¯¯å¤„ç†å’Œé»˜è®¤å¤„ç†å™¨
- âœ… ç½®ä¿¡åº¦è¯„åˆ†ç³»ç»Ÿ

### 2. è·¯ç”±ç­–ç•¥ ğŸ¯

å®ç°äº† **4ç§è·¯ç”±ç­–ç•¥**ï¼š

#### ğŸ” å…³é”®è¯è·¯ç”± (KEYWORD)
- åŸºäºé¢„å®šä¹‰çš„å…³é”®è¯åˆ—è¡¨è¿›è¡ŒåŒ¹é…
- å¿«é€Ÿã€é«˜æ•ˆ
- é€‚åˆæ˜ç¡®çš„ä»»åŠ¡åˆ†ç±»

#### ğŸ“ è§„åˆ™è·¯ç”± (RULE_BASED)
- åŸºäºæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åŒ¹é…
- ç²¾ç¡®æ§åˆ¶
- æ”¯æŒå¤æ‚çš„åŒ¹é…è§„åˆ™

#### ğŸ¤– LLM è·¯ç”± (LLM_BASED)
- ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹è¿›è¡Œæ™ºèƒ½è·¯ç”±å†³ç­–
- ç†è§£å¤æ‚æ„å›¾
- æä¾›è·¯ç”±åŸå› è¯´æ˜

#### ğŸ”„ æ··åˆè·¯ç”± (HYBRIDï¼Œæ¨è)
- ç»“åˆè§„åˆ™ã€å…³é”®è¯å’Œ LLM çš„ä¼˜åŠ¿
- å…ˆå¿«é€ŸåŒ¹é…ï¼Œå†æ™ºèƒ½å†³ç­–
- å¹³è¡¡æ•ˆç‡å’Œå‡†ç¡®æ€§

### 3. é¢„å®šä¹‰åœºæ™¯ ğŸ“¦

#### ğŸ¤– æ™ºèƒ½åŠ©æ‰‹è·¯ç”± (SmartAssistantRoutes)

åŒ…å« 6 ä¸ªä¸“ä¸šè·¯ç”±ï¼š

1. **ä»£ç ç”Ÿæˆ** (code_generation)
   - ç¼–å†™ã€ä¼˜åŒ–ã€è§£é‡Šä»£ç 
   - å…³é”®è¯ï¼šä»£ç ã€å‡½æ•°ã€ç±»ã€å®ç°ã€ç¼–ç¨‹
   
2. **å†…å®¹åˆ›ä½œ** (writing)
   - æ–‡ç« ã€æ•…äº‹ã€é‚®ä»¶ã€æ–‡æ¡ˆ
   - å…³é”®è¯ï¼šå†™ä½œã€æ–‡ç« ã€æ•…äº‹ã€é‚®ä»¶ã€æŠ¥å‘Š
   
3. **æ•°æ®åˆ†æ** (analysis)
   - åˆ†æé—®é¢˜ã€æ•°æ®ã€è¶‹åŠ¿
   - å…³é”®è¯ï¼šåˆ†æã€è¯„ä¼°ã€ç ”ç©¶ã€è°ƒæŸ¥
   
4. **ç¿»è¯‘** (translation)
   - å¤šè¯­è¨€ç¿»è¯‘
   - å…³é”®è¯ï¼šç¿»è¯‘ã€translateã€è‹±æ–‡ã€ä¸­æ–‡
   
5. **é—®ç­”** (qa)
   - å›ç­”å„ç±»é—®é¢˜
   - å…³é”®è¯ï¼šä»€ä¹ˆã€ä¸ºä»€ä¹ˆã€æ€ä¹ˆã€å¦‚ä½•
   
6. **æ‘˜è¦æ€»ç»“** (summary)
   - æå–å…³é”®ä¿¡æ¯
   - å…³é”®è¯ï¼šæ€»ç»“ã€æ‘˜è¦ã€æ¦‚æ‹¬ã€æç‚¼

#### ğŸ‘¨â€ğŸ’» å¼€å‘è€…åŠ©æ‰‹è·¯ç”± (DeveloperAssistantRoutes)

åŒ…å« 4 ä¸ªä¸“ä¸šè·¯ç”±ï¼š

1. **ä»£ç å®¡æŸ¥** (code_review)
   - æ£€æŸ¥ä»£ç è´¨é‡å’Œé—®é¢˜
   - å…³é”®è¯ï¼šå®¡æŸ¥ã€reviewã€æ£€æŸ¥ã€ä»£ç è´¨é‡
   
2. **è°ƒè¯•** (debugging)
   - æŸ¥æ‰¾å’Œä¿®å¤ bug
   - å…³é”®è¯ï¼šbugã€é”™è¯¯ã€å¼‚å¸¸ã€è°ƒè¯•ã€debug
   
3. **æ€§èƒ½ä¼˜åŒ–** (optimization)
   - æå‡ä»£ç æˆ–ç³»ç»Ÿæ€§èƒ½
   - å…³é”®è¯ï¼šä¼˜åŒ–ã€æ€§èƒ½ã€åŠ é€Ÿã€æ•ˆç‡
   
4. **æ¶æ„è®¾è®¡** (architecture)
   - ç³»ç»Ÿæ¶æ„å’ŒæŠ€æœ¯é€‰å‹
   - å…³é”®è¯ï¼šæ¶æ„ã€è®¾è®¡ã€æŠ€æœ¯é€‰å‹ã€ç³»ç»Ÿè®¾è®¡

### 4. Web API æ¥å£ ğŸŒ

**æ–‡ä»¶**: `src/shuyixiao_agent/web_app.py`

æ·»åŠ äº†æ–°çš„ API ç«¯ç‚¹ï¼š

#### POST `/api/routing/route`
æ‰§è¡Œè·¯ç”±å†³ç­–å’Œå¤„ç†
- æ”¯æŒè‡ªå®šä¹‰è·¯ç”±ç­–ç•¥
- è¿”å›è·¯ç”±å†³ç­–å’Œå¤„ç†ç»“æœ
- åŒ…å«ç½®ä¿¡åº¦å’Œè·¯ç”±åŸå› 

#### GET `/api/routing/routes`
è·å–æ‰€æœ‰å¯ç”¨çš„è·¯ç”±ä¿¡æ¯
- è·¯ç”±åç§°å’Œæè¿°
- å…³é”®è¯å’Œæ¨¡å¼
- ç¤ºä¾‹è¾“å…¥

#### GET `/api/routing/scenarios`
è·å–é¢„å®šä¹‰çš„è·¯ç”±åœºæ™¯
- æ™ºèƒ½åŠ©æ‰‹åœºæ™¯
- å¼€å‘è€…åŠ©æ‰‹åœºæ™¯

### 5. å‰ç«¯ç•Œé¢ ğŸ¨

**æ–‡ä»¶**: `src/shuyixiao_agent/static/index.html`

æ·»åŠ äº† Routing Agent å¯è§†åŒ–ç•Œé¢ï¼š

- ğŸ“Š **åœºæ™¯é€‰æ‹©å™¨**ï¼šé€‰æ‹©é¢„å®šä¹‰çš„åŠ©æ‰‹ç±»å‹
- ğŸ¯ **ç­–ç•¥é€‰æ‹©**ï¼šé€‰æ‹©è·¯ç”±ç­–ç•¥
- ğŸ“ **è¾“å…¥åŒºåŸŸ**ï¼šè¾“å…¥ä»»åŠ¡æè¿°
- ğŸ”€ **è·¯ç”±å¯è§†åŒ–**ï¼šæ˜¾ç¤ºè·¯ç”±å†³ç­–è¿‡ç¨‹
- ğŸ“ˆ **ç½®ä¿¡åº¦å±•ç¤º**ï¼šç›´è§‚æ˜¾ç¤ºåŒ¹é…ç½®ä¿¡åº¦
- ğŸ’¬ **ç»“æœå±•ç¤º**ï¼šç¾è§‚å±•ç¤ºå¤„ç†ç»“æœ
- ğŸ“‹ **è·¯ç”±å†å²**ï¼šè®°å½•å†å²è·¯ç”±å†³ç­–

### 6. ä½¿ç”¨ç¤ºä¾‹ ğŸ’¡

**æ–‡ä»¶**: `examples/12_routing_agent_demo.py`

åˆ›å»ºäº†å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹ï¼š
- âœ… æ™ºèƒ½åŠ©æ‰‹åœºæ™¯æ¼”ç¤º
- âœ… å¼€å‘è€…åŠ©æ‰‹åœºæ™¯æ¼”ç¤º
- âœ… è‡ªå®šä¹‰è·¯ç”±é…ç½®ç¤ºä¾‹
- âœ… ä¸åŒç­–ç•¥å¯¹æ¯”
- âœ… äº¤äº’å¼ä½“éªŒ

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### æ–¹å¼1: Python ä»£ç ä½¿ç”¨

```python
from src.shuyixiao_agent.gitee_ai_client import GiteeAIClient
from src.shuyixiao_agent.agents.routing_agent import (
    RoutingAgent,
    SmartAssistantRoutes,
    RoutingStrategy
)

# åˆå§‹åŒ–
llm_client = GiteeAIClient()
agent = RoutingAgent(
    llm_client=llm_client,
    strategy=RoutingStrategy.HYBRID,  # ä½¿ç”¨æ··åˆç­–ç•¥
    verbose=True
)

# æ³¨å†Œè·¯ç”±
routes = SmartAssistantRoutes.get_routes(llm_client)
agent.register_routes(routes)

# æ‰§è¡Œè·¯ç”±
result = agent.route("å¸®æˆ‘å†™ä¸€ä¸ªPythonå¿«é€Ÿæ’åºå‡½æ•°")

if result.success:
    print(f"è·¯ç”±åˆ°: {result.route_name}")
    print(f"ç½®ä¿¡åº¦: {result.confidence:.2%}")
    print(f"ç»“æœ: {result.handler_output}")
```

### æ–¹å¼2: Web ç•Œé¢ï¼ˆæ¨èï¼‰

```bash
python run_web.py
# è®¿é—® http://localhost:8001
# ç‚¹å‡» "ğŸ¯ Routing Agent" æ ‡ç­¾é¡µ
```

### æ–¹å¼3: å‘½ä»¤è¡Œæ¼”ç¤º

```bash
python examples/12_routing_agent_demo.py
```

### æ–¹å¼4: API è°ƒç”¨

```bash
# æ‰§è¡Œè·¯ç”±
curl -X POST http://localhost:8001/api/routing/route \
  -H "Content-Type: application/json" \
  -d '{
    "input_text": "ç¿»è¯‘ï¼šHello World",
    "scenario": "smart_assistant",
    "strategy": "hybrid"
  }'

# è·å–å¯ç”¨è·¯ç”±
curl http://localhost:8001/api/routing/routes?scenario=smart_assistant
```

## ğŸ“Š æ ¸å¿ƒä¼˜åŠ¿

### 1. æ™ºèƒ½åˆ†å‘ ğŸ¯
- **è‡ªåŠ¨é€‰æ‹©**ï¼šæ ¹æ®è¾“å…¥è‡ªåŠ¨é€‰æ‹©æœ€åˆé€‚çš„å¤„ç†å™¨
- **é«˜ç½®ä¿¡åº¦**ï¼šæä¾›è·¯ç”±å†³ç­–çš„ç½®ä¿¡åº¦è¯„åˆ†
- **åŸå› è¯´æ˜**ï¼šè§£é‡Šä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªè·¯ç”±

### 2. å¤šç­–ç•¥æ”¯æŒ ğŸ”„
- **è§„åˆ™è·¯ç”±**ï¼šå¿«é€Ÿã€ç²¾ç¡®çš„æ¨¡å¼åŒ¹é…
- **å…³é”®è¯è·¯ç”±**ï¼šç®€å•é«˜æ•ˆçš„å…³é”®è¯åŒ¹é…
- **LLM è·¯ç”±**ï¼šæ™ºèƒ½ç†è§£å¤æ‚æ„å›¾
- **æ··åˆè·¯ç”±**ï¼šç»“åˆæ‰€æœ‰ä¼˜åŠ¿

### 3. ä¸“ä¸šåŒ–å¤„ç† ğŸ‘¨â€ğŸ”¬
- **é¢†åŸŸä¸“å®¶**ï¼šæ¯ä¸ªè·¯ç”±éƒ½æ˜¯ç‰¹å®šé¢†åŸŸçš„ä¸“å®¶
- **é«˜è´¨é‡è¾“å‡º**ï¼šä¸“é—¨ä¼˜åŒ–çš„æç¤ºè¯
- **é’ˆå¯¹æ€§å¼º**ï¼šä¸ºç‰¹å®šä»»åŠ¡è®¾è®¡

### 4. çµæ´»æ‰©å±• ğŸ”§
- **æ˜“äºæ·»åŠ **ï¼šè½»æ¾æ·»åŠ æ–°çš„è·¯ç”±
- **è‡ªå®šä¹‰å¤„ç†å™¨**ï¼šæ”¯æŒä»»æ„å¤„ç†å‡½æ•°
- **ä¼˜å…ˆçº§æ§åˆ¶**ï¼šç²¾ç¡®æ§åˆ¶è·¯ç”±é€‰æ‹©

### 5. å¯è§‚æµ‹æ€§ ğŸ“ˆ
- **è¯¦ç»†æ—¥å¿—**ï¼šå®Œæ•´çš„è·¯ç”±å†³ç­–è¿‡ç¨‹
- **ç½®ä¿¡åº¦è¯„åˆ†**ï¼šé‡åŒ–è·¯ç”±åŒ¹é…ç¨‹åº¦
- **æ‰§è¡Œè¿½è¸ª**ï¼šè®°å½•å¤„ç†æ—¶é—´å’Œç»“æœ

## ğŸ“ è®¾è®¡æ¨¡å¼è¯¦è§£

### Routing æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³

Routingï¼ˆè·¯ç”±ï¼‰æ¨¡å¼çš„æ ¸å¿ƒæ˜¯**æ ¹æ®è¾“å…¥ç‰¹å¾æ™ºèƒ½åˆ†å‘åˆ°æœ€åˆé€‚çš„å¤„ç†å™¨**ï¼Œå°±åƒä¸€ä¸ªæ™ºèƒ½çš„äº¤é€šè°ƒåº¦ç³»ç»Ÿã€‚

#### ä¼ ç»Ÿæ–¹å¼ vs Routing æ¨¡å¼

**ä¼ ç»Ÿæ–¹å¼**ï¼š
```
ç”¨æˆ·è¾“å…¥ â†’ å•ä¸€æ¨¡å‹ â†’ è¾“å‡º
é—®é¢˜ï¼šæ¨¡å‹éœ€è¦å¤„ç†æ‰€æœ‰ç±»å‹çš„ä»»åŠ¡ï¼Œæ€§èƒ½å’Œè´¨é‡éƒ½ä¸ç†æƒ³
```

**Routing æ¨¡å¼**ï¼š
```
ç”¨æˆ·è¾“å…¥ â†’ è·¯ç”±å†³ç­–å™¨ â†’ ä¸“ä¸šå¤„ç†å™¨ â†’ é«˜è´¨é‡è¾“å‡º
          â†“              â†“
     è¯†åˆ«ä»»åŠ¡ç±»å‹    ä»£ç ç”Ÿæˆ/ç¿»è¯‘/åˆ†æ...
```

### é€‚ç”¨åœºæ™¯

âœ… **é€‚åˆä½¿ç”¨ Routing çš„æƒ…å†µ**ï¼š
- éœ€è¦å¤„ç†å¤šç§ä¸åŒç±»å‹çš„ä»»åŠ¡
- ä¸åŒä»»åŠ¡éœ€è¦ä¸åŒçš„å¤„ç†ç­–ç•¥
- å¸Œæœ›æé«˜ç‰¹å®šä»»åŠ¡çš„å¤„ç†è´¨é‡
- éœ€è¦çµæ´»çš„ä»»åŠ¡åˆ†å‘æœºåˆ¶

âŒ **ä¸é€‚åˆä½¿ç”¨ Routing çš„æƒ…å†µ**ï¼š
- åªå¤„ç†å•ä¸€ç±»å‹çš„ä»»åŠ¡
- ä»»åŠ¡ç±»å‹éš¾ä»¥åŒºåˆ†
- æ‰€æœ‰ä»»åŠ¡éƒ½éœ€è¦ç›¸åŒçš„å¤„ç†æ–¹å¼

## ğŸ“ˆ åŠŸèƒ½å¯¹æ¯”

### Routing Agent vs å…¶ä»– Agent

| ç‰¹æ€§ | Simple Agent | Tool Agent | RAG Agent | Prompt Chaining | **Routing Agent** |
|------|--------------|------------|-----------|-----------------|-------------------|
| ä»»åŠ¡åˆ†ç±» | âŒ æ—  | âš ï¸ åŸºäºå·¥å…· | âŒ æ—  | âŒ æ—  | âœ… **æ™ºèƒ½åˆ†ç±»** |
| ä¸“ä¸šåŒ– | âŒ å¼± | âš ï¸ ä¸­ç­‰ | âš ï¸ ä¾èµ–çŸ¥è¯†åº“ | âœ… å¼º | âœ… **å¾ˆå¼º** |
| çµæ´»æ€§ | âš ï¸ ä¸€èˆ¬ | âš ï¸ ä¸€èˆ¬ | âŒ ä½ | âš ï¸ ä¸­ç­‰ | âœ… **å¾ˆé«˜** |
| å¯æ‰©å±•æ€§ | âš ï¸ ä¸€èˆ¬ | âœ… å¥½ | âš ï¸ ä¸€èˆ¬ | âœ… å¥½ | âœ… **å¾ˆå¥½** |
| å†³ç­–é€æ˜ | âŒ ä½ | âš ï¸ ä¸­ç­‰ | âŒ ä½ | âœ… é«˜ | âœ… **å¾ˆé«˜** |
| é€‚ç”¨åœºæ™¯ | ç®€å•å¯¹è¯ | å·¥å…·è°ƒç”¨ | çŸ¥è¯†æŸ¥è¯¢ | å¤æ‚æµç¨‹ | **å¤šä»»åŠ¡åˆ†å‘** |

### Routing vs Prompt Chaining çš„åŒºåˆ«

| ç»´åº¦ | Prompt Chaining | Routing |
|------|----------------|---------|
| æ ¸å¿ƒæ€æƒ³ | é¡ºåºæ‰§è¡Œå¤šä¸ªæ­¥éª¤ | é€‰æ‹©æœ€åˆé€‚çš„å¤„ç†å™¨ |
| æ‰§è¡Œæ–¹å¼ | çº¿æ€§é“¾å¼ | åˆ†æ”¯é€‰æ‹© |
| é€‚ç”¨ä»»åŠ¡ | å•ä¸€å¤æ‚ä»»åŠ¡ | å¤šç§ä¸åŒä»»åŠ¡ |
| ä¼˜åŒ–æ–¹å‘ | æé«˜å•ä¸€ä»»åŠ¡è´¨é‡ | æé«˜ä»»åŠ¡åˆ†ç±»å‡†ç¡®æ€§ |
| ç¤ºä¾‹ | æ–‡æ¡£ç”Ÿæˆï¼šå¤§çº²â†’å†…å®¹â†’ç¤ºä¾‹â†’æ¶¦è‰² | è¯†åˆ«ä»»åŠ¡ç±»å‹å¹¶è·¯ç”±åˆ°ä¸“é—¨çš„å¤„ç†å™¨ |

**ä¸¤è€…å¯ä»¥ç»“åˆä½¿ç”¨**ï¼š
- å…ˆç”¨ Routing è¯†åˆ«ä»»åŠ¡ç±»å‹
- ç„¶åç”¨ Prompt Chaining æ‰§è¡Œå¤æ‚çš„å¤„ç†æµç¨‹

## ğŸ”¥ å®é™…åº”ç”¨åœºæ™¯

### åœºæ™¯1: æ™ºèƒ½å®¢æœç³»ç»Ÿ

```python
# è‡ªåŠ¨è¯†åˆ«ç”¨æˆ·æ„å›¾å¹¶è·¯ç”±åˆ°ä¸“é—¨çš„å¤„ç†æ¨¡å—
agent.route("æˆ‘çš„è®¢å•è¿˜æ²¡å‘è´§") â†’ è®¢å•æŸ¥è¯¢å¤„ç†å™¨
agent.route("å¦‚ä½•é€€æ¬¾") â†’ å”®åæœåŠ¡å¤„ç†å™¨
agent.route("äº§å“ä½¿ç”¨è¯´æ˜") â†’ æŠ€æœ¯æ”¯æŒå¤„ç†å™¨
```

### åœºæ™¯2: å¼€å‘è€…å·¥å…·

```python
# è‡ªåŠ¨è¯†åˆ«å¼€å‘ä»»åŠ¡ç±»å‹
agent.route("è¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜") â†’ ä»£ç å®¡æŸ¥
agent.route("ä¸ºä»€ä¹ˆä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸") â†’ è°ƒè¯•åŠ©æ‰‹
agent.route("å¦‚ä½•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½") â†’ æ€§èƒ½ä¼˜åŒ–
```

### åœºæ™¯3: å†…å®¹åˆ›ä½œå¹³å°

```python
# æ ¹æ®åˆ›ä½œç±»å‹é€‰æ‹©ä¸“é—¨çš„ç”Ÿæˆå™¨
agent.route("å†™ä¸€ç¯‡æŠ€æœ¯åšå®¢") â†’ æŠ€æœ¯å†™ä½œ
agent.route("ç¿»è¯‘è¿™æ®µè¯") â†’ ç¿»è¯‘æœåŠ¡
agent.route("æ€»ç»“è¿™ç¯‡æ–‡ç« ") â†’ æ‘˜è¦ç”Ÿæˆ
```

### åœºæ™¯4: æ•™è‚²è¾…åŠ©ç³»ç»Ÿ

```python
# è¯†åˆ«å­¦ä¹ éœ€æ±‚å¹¶æä¾›é’ˆå¯¹æ€§å¸®åŠ©
agent.route("è§£é‡Šé‡å­çº ç¼ ") â†’ çŸ¥è¯†è®²è§£
agent.route("å‡ºå‡ é“ç»ƒä¹ é¢˜") â†’ ä¹ é¢˜ç”Ÿæˆ
agent.route("è¿™é“é¢˜æ€ä¹ˆåš") â†’ è§£é¢˜æŒ‡å¯¼
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. è·¯ç”±è®¾è®¡åŸåˆ™

âœ… **æ¸…æ™°çš„è¾¹ç•Œ**ï¼š
- æ¯ä¸ªè·¯ç”±åº”è¯¥æœ‰æ˜ç¡®çš„è´£ä»»èŒƒå›´
- é¿å…è·¯ç”±ä¹‹é—´çš„åŠŸèƒ½é‡å 

âœ… **åˆç†çš„ä¼˜å…ˆçº§**ï¼š
- æ›´å…·ä½“çš„è·¯ç”±ä¼˜å…ˆçº§æ›´é«˜
- æ›´é¢‘ç¹çš„ä»»åŠ¡ä¼˜å…ˆçº§å¯ä»¥é€‚å½“æé«˜

âœ… **å…¨é¢çš„è¦†ç›–**ï¼š
- æä¾›é»˜è®¤å¤„ç†å™¨å¤„ç†æœªåŒ¹é…çš„æƒ…å†µ
- è€ƒè™‘è¾¹ç¼˜æƒ…å†µ

### 2. ç­–ç•¥é€‰æ‹©å»ºè®®

- **å¼€å‘/æµ‹è¯•é˜¶æ®µ**ï¼šä½¿ç”¨ `verbose=True` æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
- **é«˜æ€§èƒ½è¦æ±‚**ï¼šä¼˜å…ˆä½¿ç”¨ `RULE_BASED` æˆ– `KEYWORD` ç­–ç•¥
- **é«˜å‡†ç¡®æ€§è¦æ±‚**ï¼šä½¿ç”¨ `LLM_BASED` æˆ– `HYBRID` ç­–ç•¥
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šæ¨èä½¿ç”¨ `HYBRID` ç­–ç•¥

### 3. æ€§èƒ½ä¼˜åŒ–

```python
# 1. ä¸ºé¢‘ç¹ä»»åŠ¡è®¾ç½®æ›´é«˜ä¼˜å…ˆçº§
RouteConfig(
    name="common_task",
    priority=10,  # é«˜ä¼˜å…ˆçº§
    ...
)

# 2. ä½¿ç”¨è§„åˆ™è·¯ç”±å¤„ç†æ˜ç¡®çš„æ¨¡å¼
RouteConfig(
    pattern=r"^ç¿»è¯‘[:ï¼š]",  # æ˜ç¡®çš„å‰ç¼€
    ...
)

# 3. åˆç†è®¾ç½®å…³é”®è¯
RouteConfig(
    keywords=["ä»£ç ", "å‡½æ•°"],  # ç²¾å‡†çš„å…³é”®è¯
    ...
)
```

### 4. é”™è¯¯å¤„ç†

```python
# å§‹ç»ˆæ£€æŸ¥ç»“æœ
result = agent.route(user_input)
if result.success:
    # ä½¿ç”¨ç»“æœ
    output = result.handler_output
else:
    # å¤„ç†é”™è¯¯
    logger.error(f"è·¯ç”±å¤±è´¥: {result.error_message}")
    # æä¾›é»˜è®¤å“åº”
```

## ğŸ“ é…ç½®ç¤ºä¾‹

### è‡ªå®šä¹‰è·¯ç”±

```python
def custom_handler(input_text: str, context: Dict[str, Any]) -> str:
    """è‡ªå®šä¹‰å¤„ç†å™¨"""
    # å®ç°ä½ çš„å¤„ç†é€»è¾‘
    return f"å¤„ç†ç»“æœ: {input_text}"

# æ³¨å†Œè‡ªå®šä¹‰è·¯ç”±
agent.register_route(RouteConfig(
    name="custom_route",
    description="è‡ªå®šä¹‰è·¯ç”±",
    handler=custom_handler,
    keywords=["è‡ªå®šä¹‰", "ç‰¹æ®Š"],
    pattern=r"ç‰¹æ®Šä»»åŠ¡[:ï¼š](.+)",
    priority=10,
    examples=["ç‰¹æ®Šä»»åŠ¡ï¼šå¤„ç†è¿™ä¸ª"]
))
```

### ä½¿ç”¨å¤–éƒ¨ API ä½œä¸ºå¤„ç†å™¨

```python
import requests

def api_handler(input_text: str, context: Dict[str, Any]) -> str:
    """è°ƒç”¨å¤–éƒ¨ API"""
    response = requests.post(
        "https://api.example.com/process",
        json={"input": input_text}
    )
    return response.json()["result"]

agent.register_route(RouteConfig(
    name="external_api",
    description="å¤–éƒ¨ API å¤„ç†",
    handler=api_handler,
    ...
))
```

## ğŸ”§ æ‰©å±•åŠŸèƒ½

### å¯ä»¥æ·»åŠ çš„åŠŸèƒ½ï¼š

- [ ] è·¯ç”±æ€§èƒ½ç»Ÿè®¡å’Œç›‘æ§
- [ ] A/B æµ‹è¯•ä¸åŒè·¯ç”±é…ç½®
- [ ] åŸºäºå†å²æ•°æ®çš„è·¯ç”±ä¼˜åŒ–
- [ ] å¤šçº§è·¯ç”±ï¼ˆè·¯ç”±åˆ°è·¯ç”±å™¨ï¼‰
- [ ] å¼‚æ­¥è·¯ç”±å¤„ç†
- [ ] è·¯ç”±ç¼“å­˜æœºåˆ¶
- [ ] è·¯ç”±å¤±è´¥é‡è¯•ç­–ç•¥
- [ ] è·¯ç”±å†³ç­–å¯è§†åŒ–åˆ†æ

## ğŸ“š ç›¸å…³èµ„æº

### é¡¹ç›®æ–‡æ¡£
- ä¸»æ–‡æ¡£ï¼š`README.md`
- Web ç•Œé¢æŒ‡å—ï¼š`docs/web_interface.md`
- API å‚è€ƒï¼š`docs/api_reference.md`

### å¤–éƒ¨å‚è€ƒ
- **åŸç†æ–‡ç« **: [Agentic Design Patterns - Routing](https://github.com/ginobefun/agentic-design-patterns-cn/blob/main/08-Chapter-02-Routing.md)

## ğŸ‰ å¼€å§‹ä½¿ç”¨ï¼

```bash
# å¯åŠ¨ Web ç•Œé¢ä½“éªŒå®Œæ•´åŠŸèƒ½
python run_web.py

# æˆ–è¿è¡Œå‘½ä»¤è¡Œæ¼”ç¤º
python examples/12_routing_agent_demo.py

# æˆ–åœ¨ä½ çš„ä»£ç ä¸­ä½¿ç”¨
from src.shuyixiao_agent.agents.routing_agent import RoutingAgent
```

## ğŸ“ åé¦ˆå’Œé—®é¢˜

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿ï¼š
- æŸ¥çœ‹æ–‡æ¡£: `ROUTING_AGENT_FEATURES.md`ï¼ˆæœ¬æ–‡ä»¶ï¼‰
- æŸ¥çœ‹ç¤ºä¾‹: `examples/12_routing_agent_demo.py`
- è¿è¡Œæ¼”ç¤º: `python examples/12_routing_agent_demo.py`

---

**ğŸŠ æ­å–œï¼ä½ ç°åœ¨æ‹¥æœ‰äº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ Routing Agent ç³»ç»Ÿï¼**

é€šè¿‡æ™ºèƒ½è·¯ç”±ï¼Œè®©ä½ çš„åº”ç”¨èƒ½å¤Ÿæ ¹æ®ä»»åŠ¡ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€åˆé€‚çš„å¤„ç†æ–¹å¼ï¼Œæ˜¾è‘—æå‡ä»»åŠ¡å¤„ç†çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ï¼ğŸš€

